<!DOCTYPE html>
<html lang="hr">
    <head>
        <title>Nacionalni parkovi</title>
        <meta charset="UTF-8">
        <meta name="description" content="Baza podataka nacionalnih parkova">
        <meta name="author" content="Lucija Perković">
        <meta name="keywords" content="national parks, nacionalni parkovi, Yellowstone, Plitvička jezera">
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <link rel="stylesheet"  type="text/css" href="./styles/main.css">
    </head>
    <body>
        <main>
            <h1>Polje za pretragu</h1>
            
            
            <input type="text" name="value" placeholder="Unesite vrijednost" class="input_holder" id="myInput"  >
            <p class="p">Po ovoj vrijednosti će se pretraživati podaci.</p>
            
            
            
            <select name="search" id="search_id" class="selector">
                <option value="wildcard">Sva polja (wildcard)</option>
                <option value="nazivparka">Naziv nacionalnog parka</option>
                <option value="drzava">Država</option>
                <option value="lokacija">Lokacija</option>
                <option value="nativnevrste">Nativna vrsta</option>
                <option value="klima">Klima</option>
                <option value="sluzbenastranica">Službena stranica</option>
            </select>
            
            <br>

            <div>
                <input type="button" id="clickme" value="Prikaži" class="button" onclick="myFunction()"/>
                <a href="./JSON_CSV/nacionalni_parkovi.csv" download = "nacionalni_parkovi_csv"><input type="button" class="button" value="CSV Download"></a>
                <a href="./JSON_CSV/nacionalni_parkovi.json" download = "nacionalni_parkovi_json"><input type="button" class="button" value="JSON Download"></a>
            </div>
            
            <br><br>
            
            <table id = "myTable" class="national_parks">
                <thead>
                    <tr class="table_head">
                        <th>Naziv parka</th>
                        <th>Datum osnutka</th> 
                        <th>Država</th>
                        <th>Lokacija</th>
                        <th>Wikipedia stranica</th> 
                        <th>Prosječni broj posjetitelja godišnje</th>
                        <th>Površina</th>
                        <th>Nativna vrsta</th> 
                        <th>Službena stranica</th>
                        <th>Klima</th>
                    </tr>
                </thead>
                <tbody>
                    <% for (let park of nac_parkovi) { %>
                        
                        <tr>
                            <th class = "nazivparka"><%=park.nazivparka%></th>
                            <th><%=park.datumosnutka%></th> 
                            <th class="drzava"><%=park.drzava%></th>
                            <th class="lokacija"><%=park.lokacija%></th>
                            <th class="wikipediastranica"><%=park.wikipediastranica%></th> 
                            <th><%=park.prosjbrposjetiteljagodisnje%></th>
                            <th><%=park.povrsina%></th>
            
                            <th class="nativnevrste">
                                <% let br = 1 %>
                                <% for (let vrsta of park.nativnevrste) {%>
                                    <%=br%>. <%=vrsta%>
                                    <%br++%>
                                    <br>
                                <%}%>
                            </th> 
                            <th class="sluzbenastranica"><%=park.sluzbenastranica%></th>
                            <th class="klima"><%=park.klima%></th> 
                        </tr>
                    <% } %>
                </tbody>
            </table>
            
            
        </main>
        <script>
            function myFunction() {
                var input, filter, table, tr, th, i, txtValue, valueSelector;
                var wildcardSelector = ["nazivparka", "drzava", "lokacija", "wikipediastranica", "nativnevrste", "sluzbenastranica", "klima"];
                input = document.getElementById("myInput");
                filter = input.value.toUpperCase();
                table = document.getElementById("myTable");
                tr = table.getElementsByTagName("tr");
                valueSelector = document.getElementById("search_id").value;
                var hidden;
                if(valueSelector == "wildcard"){
                        for (i = 1; i < tr.length; i++) {
                            for(j = 0; j < 10; j++){
                                th = tr[i].getElementsByTagName("th")[j];
                                tr[i].style.display = "none";
                                  
                            } 
                            for(j = 0; j<10;j++){
                                th = tr[i].getElementsByTagName("th")[j];
                                
                                if (th) {
                                    txtValue = th.textContent || th.innerText;
                                    console.log(txtValue);
                                    
                                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                                        tr[i].style.display = "";
                                    } 
                                    
                                }  
                            }      
                        }
                    
                }
                else{
                        for (i = 0; i < tr.length; i++) {
                            th = tr[i].getElementsByClassName(valueSelector)[0];
                            if (th) {
                                txtValue = th.textContent || th.innerText;
                                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                                    tr[i].style.display = "";
                                } else {
                                    tr[i].style.display = "none";
                                }
                            }       
                    }
                }
                
                
            }
        </script>
    </body>
</html>